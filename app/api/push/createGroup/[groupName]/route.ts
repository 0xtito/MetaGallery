import type { NextApiRequest, NextApiResponse, NextPageContext } from "next";
import { NextResponse } from "next/server";
import { ethers } from 'ethers';
import * as PushAPI from '@pushprotocol/restapi';
import { ENV } from '@pushprotocol/restapi/src/lib/constants'


export async function POST(
  request: NextApiRequest,
  context: { params: { groupName: string } }
) {
  const { groupName } = context.params;

  const groupAdminPrivateKey = process.env.GROUP_ADMIN_PRIVATE_KEY;
  const signer = new ethers.Wallet(`0x${process.env.GROUP_ADMIN_PRIVATE_KEY}`)

  const user = await PushAPI.user.get({
    account: `eip155:${signer.address}`,
    env: ENV.PROD
  })

  const pgpDecrpyptedPvtKey = await PushAPI.chat.decryptPGPKey({
    encryptedPGPPrivateKey: user.encryptedPrivateKey,
    signer: signer
  })

  const response = await PushAPI.chat.createGroup({
    groupName: groupName,
    groupDescription: groupName,
    members: ['eip155:0x34c0a76572d29170C301aF4Eb22d17620A371d4A'],
    groupImage:
      'data:image/jpeg;base64,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',
    admins: [],
    isPublic: false,
    contractAddressNFT: 'eip155:137:0xD7a1f5de17ebcC376889128a5d6C7696508f0A69',
    numberOfNFTs: 1,
    account: signer.address, //Group Admin
    signer: signer,
    pgpPrivateKey: pgpDecrpyptedPvtKey,
    env: ENV.PROD,
    rules: {}
  })

  return NextResponse.json({
    response
  });
}
